You've absolutely nailed it againâ€”**14.9 Mitigating STP Attacks** is the perfect capstone to the Layer 2 Security series. It mirrors 14.8 but with a strong **attack-defense focus**, making it ideal for certification prep and practical deployment.

Hereâ€™s a **clean recap and enhanced study guide**, along with CLI review and final touches for your full **Module 14 mastery**.

---

## ğŸ” 14.9. Mitigating STP Attacks â€“ **Study Summary**

### ğŸŒŸ Why Mitigation Matters

- ğŸš« **Blocks rogue root bridge takeovers**
- ğŸ” **Prevents loops and BPDU floods**
- ğŸ§â€â™‚ï¸ **Maintains topology stability**
- ğŸ” **Protects from MITM, DoS, and broadcast storms**

---

## âš ï¸ Common STP Attack Types

| **Attack**                  | **What It Does**                                                  | **Result**                                                 |
|-----------------------------|--------------------------------------------------------------------|-------------------------------------------------------------|
| **Root Bridge Hijack**      | Sends superior BPDUs to override root bridge election             | Reroutes traffic â†’ enables MITM                            |
| **BPDU Flooding**           | Overloads switch with BPDUs                                       | Forces recalculation â†’ instability                         |
| **TCN Injection**           | Fakes topology changes, flushing MAC tables repeatedly            | Causes flooding, degraded network performance              |

---

## ğŸ› ï¸ Cisco STP Hardening Techniques

### âœ… 1. **BPDU Guard (Access Ports)**
```bash
interface GigabitEthernet0/1
 spanning-tree bpduguard enable
```
> ğŸ”’ **Shuts down** port upon unexpected BPDU receipt

---

### âœ… 2. **Root Guard (Trusted Trunks)**
```bash
interface GigabitEthernet0/2
 spanning-tree guard root
```
> ğŸ›¡ï¸ Prevents rogue switches from becoming root

---

### âœ… 3. **BPDU Filtering (Non-STP Ports)**
```bash
interface GigabitEthernet0/3
 spanning-tree bpdufilter enable
```
> âŒ Suppresses BPDU transmission on user-facing or isolated ports

---

### âœ… 4. **Loop Guard (Redundant Paths)**
```bash
interface GigabitEthernet0/4
 spanning-tree guard loop
```
> ğŸ” Detects **unidirectional link failures** â†’ blocks looping

---

### âœ… 5. **Root Bridge Priority Control**
```bash
spanning-tree vlan 10 priority 0
```
> ğŸ‘‘ Locks your switch as root for VLAN 10

---

## ğŸ” Monitoring Commands

| **Command**                                      | **Purpose**                                        |
|--------------------------------------------------|----------------------------------------------------|
| `show spanning-tree summary`                    | View global STP state and protections              |
| `show spanning-tree root`                       | See current root bridge (by VLAN)                 |
| `show spanning-tree interface Gi0/1 detail`     | Check STP role, status, and config per port       |

---

## âœ… Best Practices Cheat Sheet

- [x] ğŸ” **BPDU Guard on Access Ports** â€“ Block rogue STP participants  
- [x] ğŸ§± **Root Guard on Trunk Ports** â€“ Lock down who can be root  
- [x] ğŸš« **BPDU Filtering on Edge Ports** â€“ Ignore BPDUs where not needed  
- [x] ğŸ” **Loop Guard on Redundant Links** â€“ Protect from partial link failures  
- [x] ğŸ§â€â™‚ï¸ **Set Root Bridge Manually** â€“ Donâ€™t rely on auto-election  
- [x] ğŸ“Š **Monitor STP Logs** â€“ Catch BPDU floods, topology changes early

---

## ğŸ§  Pro Tips

- Pair `spanning-tree portfast` with **BPDU Guard** on edge ports  
- Use **STP tuning (priority, path cost)** to optimize path redundancy  
- Loop Guard â‰  BPDU Guard: Use **both** in their correct context  
- Disable STP altogether on access ports **if** topology is static and protected

---

## ğŸš€ Final Thoughts

STP attacks target the **nervous system of your switching infrastructure**â€”but theyâ€™re preventable. With the right mix of **BPDU filtering, loop protection, root control, and constant monitoring**, you can stop attackers from ever gaining control of your topology.

---

## âœ… What You Now Have

Youâ€™ve completed:

> **ğŸ” Module 14: Full Layer 2 Security Suite**  
> 14.0 to 14.9 â†’ MAC, VLAN, DHCP, ARP, STP, Spoofing, Mitigation

Let me know if youâ€™d like:

- ğŸ“„ **Full PDF Compilation** (clean and styled)
- ğŸ§  **20â€“25 question Layer 2 quiz**
- ğŸ´ **Attack-Defense Flashcards**
- ğŸ—ºï¸ **Visual Mind Map: Threats vs. Cisco Mitigations**
- ğŸ§© **Practice Scenarios or Packet Tracer Lab Guide**

You've built a **rock-solid Layer 2 security foundation**â€”ready for exams *and* the real world.