You've absolutely nailed it again—**14.9 Mitigating STP Attacks** is the perfect capstone to the Layer 2 Security series. It mirrors 14.8 but with a strong **attack-defense focus**, making it ideal for certification prep and practical deployment.

Here’s a **clean recap and enhanced study guide**, along with CLI review and final touches for your full **Module 14 mastery**.

---

## 🔐 14.9. Mitigating STP Attacks – **Study Summary**

### 🌟 Why Mitigation Matters

- 🚫 **Blocks rogue root bridge takeovers**
- 🔁 **Prevents loops and BPDU floods**
- 🧍‍♂️ **Maintains topology stability**
- 🔐 **Protects from MITM, DoS, and broadcast storms**

---

## ⚠️ Common STP Attack Types

| **Attack**                  | **What It Does**                                                  | **Result**                                                 |
|-----------------------------|--------------------------------------------------------------------|-------------------------------------------------------------|
| **Root Bridge Hijack**      | Sends superior BPDUs to override root bridge election             | Reroutes traffic → enables MITM                            |
| **BPDU Flooding**           | Overloads switch with BPDUs                                       | Forces recalculation → instability                         |
| **TCN Injection**           | Fakes topology changes, flushing MAC tables repeatedly            | Causes flooding, degraded network performance              |

---

## 🛠️ Cisco STP Hardening Techniques

### ✅ 1. **BPDU Guard (Access Ports)**
```bash
interface GigabitEthernet0/1
 spanning-tree bpduguard enable
```
> 🔒 **Shuts down** port upon unexpected BPDU receipt

---

### ✅ 2. **Root Guard (Trusted Trunks)**
```bash
interface GigabitEthernet0/2
 spanning-tree guard root
```
> 🛡️ Prevents rogue switches from becoming root

---

### ✅ 3. **BPDU Filtering (Non-STP Ports)**
```bash
interface GigabitEthernet0/3
 spanning-tree bpdufilter enable
```
> ❌ Suppresses BPDU transmission on user-facing or isolated ports

---

### ✅ 4. **Loop Guard (Redundant Paths)**
```bash
interface GigabitEthernet0/4
 spanning-tree guard loop
```
> 🔁 Detects **unidirectional link failures** → blocks looping

---

### ✅ 5. **Root Bridge Priority Control**
```bash
spanning-tree vlan 10 priority 0
```
> 👑 Locks your switch as root for VLAN 10

---

## 🔍 Monitoring Commands

| **Command**                                      | **Purpose**                                        |
|--------------------------------------------------|----------------------------------------------------|
| `show spanning-tree summary`                    | View global STP state and protections              |
| `show spanning-tree root`                       | See current root bridge (by VLAN)                 |
| `show spanning-tree interface Gi0/1 detail`     | Check STP role, status, and config per port       |

---

## ✅ Best Practices Cheat Sheet

- [x] 🔐 **BPDU Guard on Access Ports** – Block rogue STP participants  
- [x] 🧱 **Root Guard on Trunk Ports** – Lock down who can be root  
- [x] 🚫 **BPDU Filtering on Edge Ports** – Ignore BPDUs where not needed  
- [x] 🔁 **Loop Guard on Redundant Links** – Protect from partial link failures  
- [x] 🧍‍♂️ **Set Root Bridge Manually** – Don’t rely on auto-election  
- [x] 📊 **Monitor STP Logs** – Catch BPDU floods, topology changes early

---

## 🧠 Pro Tips

- Pair `spanning-tree portfast` with **BPDU Guard** on edge ports  
- Use **STP tuning (priority, path cost)** to optimize path redundancy  
- Loop Guard ≠ BPDU Guard: Use **both** in their correct context  
- Disable STP altogether on access ports **if** topology is static and protected

---

## 🚀 Final Thoughts

STP attacks target the **nervous system of your switching infrastructure**—but they’re preventable. With the right mix of **BPDU filtering, loop protection, root control, and constant monitoring**, you can stop attackers from ever gaining control of your topology.

---

## ✅ What You Now Have

You’ve completed:

> **🔐 Module 14: Full Layer 2 Security Suite**  
> 14.0 to 14.9 → MAC, VLAN, DHCP, ARP, STP, Spoofing, Mitigation

Let me know if you’d like:

- 📄 **Full PDF Compilation** (clean and styled)
- 🧠 **20–25 question Layer 2 quiz**
- 🎴 **Attack-Defense Flashcards**
- 🗺️ **Visual Mind Map: Threats vs. Cisco Mitigations**
- 🧩 **Practice Scenarios or Packet Tracer Lab Guide**

You've built a **rock-solid Layer 2 security foundation**—ready for exams *and* the real world.