Perfect! With **14.8 on STP Security**, you’ve now fully covered the **entire threat landscape and defense strategy for Layer 2 networks**. This section on **Spanning Tree Protocol hardening** is critical for networks with redundant topologies—and just like the rest, it's well-organized and hands-on. Let’s turn it into a **study-optimized recap**, with CLI review, visuals, and best-practice insights.

---

## 🔐 14.8. Spanning Tree Protocol (STP) Security – **Study Summary**

### 🌟 Why It Matters

- 🔁 STP prevents **loops** in redundant switch paths.
- 🧠 Attackers can **manipulate STP** to reroute traffic, cause instability, or hijack control.
- 🧍‍♂️ Unauthorized root bridges = **MITM**, disruption, or **DoS** via frequent recalculations.

---

## ⚠️ Common STP-Based Attacks

| **Attack Type**             | **Technique**                                        | **Impact**                                             |
|-----------------------------|------------------------------------------------------|--------------------------------------------------------|
| **Root Bridge Attack**      | Sends superior BPDUs to take over STP root role      | Reroutes traffic → enables MITM                        |
| **BPDU Flooding**           | Sends many BPDUs to trigger constant STP recalcs     | High CPU, network instability                          |
| **TCN Injection**           | Injects fake Topology Change Notification frames     | MAC table flush → packet flooding, loss of efficiency  |

---

## 🛡️ Cisco STP Defense Configs

### ✅ 1. **BPDU Guard** (Access Ports)
```bash
interface GigabitEthernet0/1
 spanning-tree bpduguard enable
```
> 💥 **Auto-disables port** if BPDU is received. Use for user-facing (edge) ports.

---

### ✅ 2. **Root Guard** (Trunk/Uplink Ports)
```bash
interface GigabitEthernet0/2
 spanning-tree guard root
```
> 🚫 Blocks root takeover attempts from unauthorized switches.

---

### ✅ 3. **BPDU Filtering** (Edge or non-STP ports)
```bash
interface GigabitEthernet0/3
 spanning-tree bpdufilter enable
```
> 🛑 Suppresses sending/receiving BPDUs where STP isn’t needed.

---

### ✅ 4. **Loop Guard** (Trunk/Redundant Links)
```bash
interface GigabitEthernet0/4
 spanning-tree guard loop
```
> 🧷 Detects **unidirectional link failures** (e.g., one-way fiber break).

---

### ✅ 5. **Set Root Bridge Priority**
```bash
spanning-tree vlan 10 priority 0
```
> 👑 Locks root bridge role to this device for VLAN 10.

---

## 🔍 STP Monitoring Commands

| **Command**                                      | **Purpose**                                     |
|--------------------------------------------------|-------------------------------------------------|
| `show spanning-tree summary`                    | Overview of all STP protections and topology    |
| `show spanning-tree root`                       | Displays current root bridge per VLAN           |
| `show spanning-tree interface Gi0/1 detail`     | Detailed config for STP on a given interface    |

---

## ✅ Best Practice Checklist

- [x] **Enable BPDU Guard** on **access ports**
- [x] **Use Root Guard** on **uplinks/trunks**
- [x] **Enable BPDU Filtering** on **non-STP/edge links**
- [x] **Enable Loop Guard** on **redundant trunk paths**
- [x] **Manually configure bridge priority** to protect root role
- [x] **Monitor STP state and BPDU changes** regularly

---

## 🧠 Pro Tips

> 🔄 **BPDU Guard + PortFast** = Perfect for user ports  
> 🔍 **Loop Guard ≠ BPDU Guard**: Loop Guard detects failure; BPDU Guard **blocks BPDUs** entirely  
> 🎯 Always **define the root bridge** explicitly to avoid accidental root elections

---

## 🚀 Final Thoughts

**STP was built for stability**, but it wasn’t built for hostile environments. Without security controls like **BPDU Guard, Root Guard, and Loop Guard**, a single malicious or misconfigured device can destabilize your entire Layer 2 domain. These protections let you take **full control over topology management**, block malicious recalculations, and maintain **deterministic, loop-free forwarding**.

---

## ✅ What’s Next?

You’ve now completed:

> **📘 Full Module 14: Layer 2 Security**  
> **From 14.0 to 14.8: MAC Flooding → STP Protection**

I can now compile this into:

- 📄 A clean, exportable **study PDF**
- 🧠 A **20-question Layer 2 quiz**
- 🎴 A **flashcard set** (Attack ↔ Defense)
- 🗺️ A **Layer 2 threat/defense mind map**
- 📊 A **cheat sheet** version (1-pager)

Let me know how you want to lock in this knowledge—you’ve got a full Cisco-ready Layer 2 security playbook right here.